"use strict";(self["webpackChunkdesafio_pontotel"]=self["webpackChunkdesafio_pontotel"]||[]).push([[224],{6730:(e,o,t)=>{t.r(o),t.d(o,{default:()=>y});var r=t(3673);const a={style:{background:"linear-gradient(#261479, #443780)"}},s={class:"banner transparent"},i={class:"borderFrame"},l=(0,r._)("div",{class:"textBanner q-mt-md q-mb-xs"},"Olá Visitante",-1),n={class:"q-pa-sm"};function d(e,o,t,d,c,m){const h=(0,r.up)("q-icon"),u=(0,r.up)("q-input"),p=(0,r.up)("q-btn"),g=(0,r.up)("DialogRegister");return(0,r.wg)(),(0,r.iD)("div",a,[(0,r._)("div",s,[(0,r._)("div",i,[l,(0,r._)("div",n,[(0,r.Wm)(u,{modelValue:c.email,"onUpdate:modelValue":o[0]||(o[0]=e=>c.email=e),error:c.errorEmail,"bg-color":"white",color:"black",outlined:"","error-message":"Este campo é obrigado a estar preenchido",label:"E-mail"},{prepend:(0,r.w5)((()=>[(0,r.Wm)(h,{name:"email",color:"dark"})])),_:1},8,["modelValue","error"]),(0,r.Wm)(u,{class:"input",modelValue:c.cpfPis,"onUpdate:modelValue":o[1]||(o[1]=e=>c.cpfPis=e),error:c.errorCpfPis,"bg-color":"white",color:"black",outlined:"","error-message":"Este campo é obrigado a estar preenchido",label:"CPF ou PIS"},{prepend:(0,r.w5)((()=>[(0,r.Wm)(h,{name:"person",color:"dark"})])),_:1},8,["modelValue","error"]),(0,r.Wm)(u,{type:"password",class:"input",modelValue:c.password,"onUpdate:modelValue":o[2]||(o[2]=e=>c.password=e),error:c.errorPassword,"bg-color":"white",color:"black",outlined:"","error-message":"Este campo é obrigado a estar preenchido",label:"Senha"},{prepend:(0,r.w5)((()=>[(0,r.Wm)(h,{name:"lock",color:"dark"})])),_:1},8,["modelValue","error"]),(0,r.Wm)(p,{onClick:m.dialogRegister,size:"12px",flat:"",label:"Cadastrar-se",class:"text-white float-right"},null,8,["onClick"]),(0,r.Wm)(p,{onClick:m.authLogin,rounded:"",class:"button",label:"Login",disable:c.lockButton},null,8,["onClick","disable"]),(0,r.Wm)(g,{ref:"dialogRegister"},null,512)])])])])}var c=t(9281),m=t(5429),h=t.n(m);class u{constructor(){h()(this,"Email",""),h()(this,"CpfPis",""),h()(this,"Password","")}}function p(){return new Promise((e=>{var o=localStorage.getItem("token");e(atob(o.split(".")[1]))}))}var g=t(2248);const f={name:"Index",components:{DialogRegister:g.Z},data(){return{email:"",cpfPis:"",password:"",lockButton:!1,errorEmail:!1,errorCpfPis:!1,errorPassword:!1}},methods:{dialogRegister(){this.$refs.dialogRegister.show(null,"Cadastrar novo usuário",!1)},pageHome(){this.$router.push("home")},verifyToken(){var e=localStorage.getItem("token");null!=e&&(0,c.dX)("auth/token").then((e=>{200==e.status&&this.pageHome()})).catch((e=>{}))},authLogin(){this.validateData().then((()=>{this.confirmAction("Deseja realmente se logar ?").then((()=>{this.lockButton=!0;var e=new u;e.CpfPis=this.cpfPis,e.Email=this.email,e.Password=this.password;try{(0,c.SO)("auth/login",e).then((async e=>{this.$q.loading.show({message:"Aguarde enquanto verificamos..."}),localStorage.setItem("token",e.data.token),localStorage.setItem("tokenContent",await p()),setTimeout((()=>{!0===e.data.status?(this.$q.notify({message:e.data.msg,color:"green"}),this.pageHome()):this.$q.notify({message:e.data.msg,color:"red"})}),250)})).catch((e=>{console.log(e),this.$q.notify({message:"Erro ao fazer autenticação",color:"red"}),this.timer=setTimeout((()=>{this.$q.loading.hide(),this.timer=void 0}),1e3)}))}catch(o){console.log(o)}finally{this.lockButton=!1}this.timer=setTimeout((()=>{this.$q.loading.hide(),this.timer=void 0}),1e3)}))}))},confirmAction(e){return new Promise(((o,t)=>{this.$q.dialog({dark:!0,title:e,cancel:"Sair",persistent:!0}).onOk((()=>{o()}))}))},validateData(){return new Promise((e=>{var o=!1;""==this.email||null==this.email?(this.errorEmail=!0,o=!0):(this.errorEmail=!1,o=!1),""==this.cpfPis||null==this.cpfPis?(this.errorCpfPis=!0,o=!0):(this.errorCpfPis=!1,o=!1),""==this.password||null==this.password?(this.errorPassword=!0,o=!0):(this.errorPassword=!1,o=!1),0==o&&e(!1)}))}},beforeMount(){this.verifyToken()},beforeDestroy(){void 0!==this.timer&&(clearTimeout(this.timer),this.$q.loading.hide())}};var k=t(4260),w=t(4842),b=t(4554),P=t(8240),v=t(7518),C=t.n(v);const q=(0,k.Z)(f,[["render",d]]),y=q;C()(f,"components",{QInput:w.Z,QIcon:b.Z,QBtn:P.Z})}}]);